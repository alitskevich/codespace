<components>
  <component id="Page.AddText">
    <BrowserService Ref="browser" title="{R.name}" />
    <UploaderService Ref="uploader" acquired="<-db.allAcquired|arrayToObject" />


    <Connector data="{R.samples.text1}" change="-> uploader.uploadText(it)" />

    <!-- <Connector data="<-uploader.word" change="-> value" /> -->

    <Container class="w-full md:h-full flex flex-col md:grid md:grid-cols-3 p-4 gap-4 pt-[6rem]">
      <div class="col-span-3">
        <MarkedText data="<-uploader.parsedText" class="flex-1 overflow-y-auto !text-xl" />
      </div>
      <div class="{R.styles.card} overflow-y-auto ">
        <div class="flex items-start flex-wrap text-2xl gap-2">
          <Word Each="item of <-uploader.list|filter:'acquired':-1" item="{item}" />
        </div>
      </div>
      <div class="{R.styles.card} overflow-y-auto ">
        <div class="flex items-start flex-wrap text-2xl gap-2">
          <Word Each="item of <-uploader.list|filter:'acquired':0" item="{item}" />
        </div>
      </div>
      <div class="{R.styles.card} overflow-y-auto ">
        <div class="flex items-start flex-wrap text-2xl gap-2">
          <Word Each="item of <-uploader.list|filter:'acquired':1" item="{item}" />
        </div>
      </div>
    </Container>

    <AddText />
    <Header />
  </component>

  <component id="AddText">

    <StoredData Ref="text" defaults="{R.samples.text1}" />

    <Connector trigger="{counter}" data="<-text.value" change="-> uploader.uploadText(it)" />
    <Connector trigger="{counter}" change="-> opened=false" />

    <StoredData Ref="fromClipboard" defaults="<-browser.fromClipboard" persistence="inmemory" />

    <FAB class="select-none" mode="primary" title="+" action="-> opened=true" />
    <Modal open="{opened}" If="opened" close="-> opened=false" class="top-12">
      <Modal:header>
        <div class="flex justify-between items-center w-full pr-4">
          <h3 class="text-xl font-semibold text-sky-500">Input a new text</h3>
          <Btn title="Paste" action="-> text.value=fromClipboard.value" />
        </div>
      </Modal:header>
      <div>
        <textarea autofocus class="input px-2 w-full" style="min-height:16rem;" change="-> text.value=it.value"
          value="<-text.value"></textarea>
      </div>
      <Modal:footer>
        <div class="flex justify-between w-full">
          <FieldHint class="mt-4 flex-1" value="{hint}" />
          <Btn class="" mode="primary" title="OK" action="-> counter = counter ?? 0 | increment" />
        </div>
      </Modal:footer>
    </Modal>
  </component>

</components>